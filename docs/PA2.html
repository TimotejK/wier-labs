<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Programming assignment 2 | Web Information Extraction and Retrieval</title>
  <meta name="description" content="Instructions for the Web Information Extraction and Retrieval course labs" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Programming assignment 2 | Web Information Extraction and Retrieval" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Instructions for the Web Information Extraction and Retrieval course labs" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Programming assignment 2 | Web Information Extraction and Retrieval" />
  
  <meta name="twitter:description" content="Instructions for the Web Information Extraction and Retrieval course labs" />
  

<meta name="author" content="Timotej Knez, Melanija Vezočnik, prof. dr. Marko Bajec, Slavko Žitnik" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="PA1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Web Information Extraction and Retrieval</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About the course</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lab-work"><i class="fa fa-check"></i>Lab work</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#programming-assignments"><i class="fa fa-check"></i>Programming assignments</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-projects-alternative-to-the-programming-assignments"><i class="fa fa-check"></i>Course projects (alternative to the programming assignments)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="PA1.html"><a href="PA1.html"><i class="fa fa-check"></i><b>1</b> Programming assignment 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="PA1.html"><a href="PA1.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="PA1.html"><a href="PA1.html#instructions"><i class="fa fa-check"></i><b>1.2</b> Instructions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="PA1.html"><a href="PA1.html#crawldb-design"><i class="fa fa-check"></i><b>1.2.1</b> Crawldb design</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="PA1.html"><a href="PA1.html#basic-tools"><i class="fa fa-check"></i><b>1.3</b> Basic tools</a></li>
<li class="chapter" data-level="1.4" data-path="PA1.html"><a href="PA1.html#what-to-include-in-the-report"><i class="fa fa-check"></i><b>1.4</b> What to include in the report</a></li>
<li class="chapter" data-level="1.5" data-path="PA1.html"><a href="PA1.html#what-to-submit"><i class="fa fa-check"></i><b>1.5</b> What to submit</a></li>
<li class="chapter" data-level="1.6" data-path="PA1.html"><a href="PA1.html#grading-schema"><i class="fa fa-check"></i><b>1.6</b> Grading schema</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="PA2.html"><a href="PA2.html"><i class="fa fa-check"></i><b>2</b> Programming assignment 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="PA2.html"><a href="PA2.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="PA2.html"><a href="PA2.html#identifying-and-extracting-information"><i class="fa fa-check"></i><b>2.2</b> Identifying and extracting information</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="PA2.html"><a href="PA2.html#using-xpath-expressions"><i class="fa fa-check"></i><b>2.2.1</b> Using XPath expressions</a></li>
<li class="chapter" data-level="2.2.2" data-path="PA2.html"><a href="PA2.html#using-regular-expressions"><i class="fa fa-check"></i><b>2.2.2</b> Using regular expressions</a></li>
<li class="chapter" data-level="2.2.3" data-path="PA2.html"><a href="PA2.html#your-task"><i class="fa fa-check"></i><b>2.2.3</b> Your task</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="PA2.html"><a href="PA2.html#storing-extracted-information-in-a-vector-database"><i class="fa fa-check"></i><b>2.3</b> Storing extracted information in a vector database</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="PA2.html"><a href="PA2.html#preparing-the-database"><i class="fa fa-check"></i><b>2.3.1</b> Preparing the database</a></li>
<li class="chapter" data-level="2.3.2" data-path="PA2.html"><a href="PA2.html#generate-vector-embeddings"><i class="fa fa-check"></i><b>2.3.2</b> Generate vector embeddings</a></li>
<li class="chapter" data-level="2.3.3" data-path="PA2.html"><a href="PA2.html#querying-the-database"><i class="fa fa-check"></i><b>2.3.3</b> Querying the database</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="PA2.html"><a href="PA2.html#information-retrieval"><i class="fa fa-check"></i><b>2.4</b> Information retrieval</a></li>
<li class="chapter" data-level="2.5" data-path="PA2.html"><a href="PA2.html#basic-tools-1"><i class="fa fa-check"></i><b>2.5</b> Basic tools</a></li>
<li class="chapter" data-level="2.6" data-path="PA2.html"><a href="PA2.html#what-to-submit-1"><i class="fa fa-check"></i><b>2.6</b> What to submit</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="PA2.html"><a href="PA2.html#what-to-include-in-the-report-1"><i class="fa fa-check"></i><b>2.6.1</b> What to include in the report</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://ucilnica.fri.uni-lj.si">Moodle classroom</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Web Information Extraction and Retrieval</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="PA2" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Programming assignment 2<a href="PA2.html#PA2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="img/book/spider-01.png" /></p>
<div id="introduction-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction<a href="PA2.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The goal of this programming assignment is to extract useful information from the crawled websites and store it in a vector database for answering domain-specific questions. The assignment consists of three parts:</p>
<ul>
<li><ol style="list-style-type: upper-alpha">
<li>Identifying and extracting important information<br />
</li>
</ol></li>
<li><ol start="2" style="list-style-type: upper-alpha">
<li>Storing information to a vector database<br />
</li>
</ol></li>
<li><ol start="3" style="list-style-type: upper-alpha">
<li>Retrieving information relevant to the query</li>
</ol></li>
</ul>
</div>
<div id="identifying-and-extracting-information" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Identifying and extracting information<a href="PA2.html#identifying-and-extracting-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this part of the assignment, your task is to identify meaningful content (such as article titles, product names, descriptions, prices, or publication dates) from HTML documents and extract it in a structured format. The goal is to prepare high-quality data that can later be stored in a vector database and queried efficiently.</p>
<p>You will explore two main techniques: XPath expressions and regular expressions.</p>
<div id="using-xpath-expressions" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Using XPath expressions<a href="PA2.html#using-xpath-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One approach to navigate XML and HTML files is to use XPath expressions. XPath (XML Path Language) is a syntax for navigating through elements and attributes in an XML/HTML document tree.</p>
<p>XPath allows you to:</p>
<ul>
<li>Select nodes or node-sets in an XML document</li>
<li>Navigate based on element names, attribute values, and hierarchy</li>
<li>Perform conditional searches using predicates</li>
</ul>
<p><strong>Basic XPath Syntax:</strong></p>
<ul>
<li><code>/html/body/div</code> — selects a <code>div</code> element that is a child of <code>body</code>, which is a child of <code>html</code></li>
<li><code>//p</code> — selects all <code>&lt;p&gt;</code> elements in the document</li>
<li><code>//div[@class="content"]</code> — selects all <code>&lt;div&gt;</code> elements with a class attribute equal to “content”</li>
<li><code>//a[@href]</code> — selects all anchor tags with an <code>href</code> attribute</li>
</ul>
<p><strong>Python Example Using XPath:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="PA2.html#cb1-1" tabindex="-1"></a><span class="im">from</span> lxml <span class="im">import</span> html</span>
<span id="cb1-2"><a href="PA2.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="PA2.html#cb1-3" tabindex="-1"></a>html_content <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb1-4"><a href="PA2.html#cb1-4" tabindex="-1"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb1-5"><a href="PA2.html#cb1-5" tabindex="-1"></a><span class="st">  &lt;body&gt;</span></span>
<span id="cb1-6"><a href="PA2.html#cb1-6" tabindex="-1"></a><span class="st">    &lt;div class=&quot;article&quot;&gt;</span></span>
<span id="cb1-7"><a href="PA2.html#cb1-7" tabindex="-1"></a><span class="st">      &lt;h2&gt;Sample Article&lt;/h2&gt;</span></span>
<span id="cb1-8"><a href="PA2.html#cb1-8" tabindex="-1"></a><span class="st">      &lt;p&gt;This is a test paragraph.&lt;/p&gt;</span></span>
<span id="cb1-9"><a href="PA2.html#cb1-9" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb1-10"><a href="PA2.html#cb1-10" tabindex="-1"></a><span class="st">  &lt;/body&gt;</span></span>
<span id="cb1-11"><a href="PA2.html#cb1-11" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb1-12"><a href="PA2.html#cb1-12" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb1-13"><a href="PA2.html#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="PA2.html#cb1-14" tabindex="-1"></a>tree <span class="op">=</span> html.fromstring(html_content)</span>
<span id="cb1-15"><a href="PA2.html#cb1-15" tabindex="-1"></a>title <span class="op">=</span> tree.xpath(<span class="st">&#39;//div[@class=&quot;article&quot;]/h2/text()&#39;</span>)</span>
<span id="cb1-16"><a href="PA2.html#cb1-16" tabindex="-1"></a><span class="bu">print</span>(title)  <span class="co"># Output: [&#39;Sample Article&#39;]</span></span></code></pre></div>
</div>
<div id="using-regular-expressions" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Using regular expressions<a href="PA2.html#using-regular-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another approach to content extraction is using <strong>regular expressions</strong> (regex). Regular expressions are powerful tools for pattern matching and text processing. While regex can be faster for small and well-structured tasks, it is more error-prone for messy or deeply nested HTML. Use it when you know the structure of the text you’re working with and want to quickly extract specific elements.</p>
<p><strong>Basic Regex Syntax:</strong></p>
<ul>
<li><code>.</code> — matches any character except newline<br />
</li>
<li><code>*</code> — matches 0 or more repetitions<br />
</li>
<li><code>+</code> — matches 1 or more repetitions<br />
</li>
<li><code>?</code> — makes the preceding token optional<br />
</li>
<li><code>[]</code> — matches any one character in the brackets<br />
</li>
<li><code>()</code> — groups expressions<br />
</li>
<li><code>\d</code> — matches any digit<br />
</li>
<li><code>\s</code> — matches whitespace</li>
<li><code>^</code> — matches the start of a string</li>
<li><code>$</code> — matches the end of a string</li>
</ul>
<p><strong>Common Regex Examples and What They Match:</strong></p>
<table>
<colgroup>
<col width="30%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>Regular Expression</th>
<th>Matches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&lt;h2&gt;(.*?)&lt;/h2&gt;</code></td>
<td>The text inside an <code>&lt;h2&gt;</code> tag</td>
</tr>
<tr class="even">
<td><code>href="(.*?)"</code></td>
<td>The value of an <code>href</code> attribute</td>
</tr>
<tr class="odd">
<td><code>&lt;p&gt;(.*?)&lt;/p&gt;</code></td>
<td>Paragraph content between <code>&lt;p&gt;</code> tags</td>
</tr>
<tr class="even">
<td><code>\d{4}-\d{2}-\d{2}</code></td>
<td>Dates in <code>YYYY-MM-DD</code> format</td>
</tr>
<tr class="odd">
<td><code>\$[0-9]+\.[0-9]{2}</code></td>
<td>Dollar amounts like <code>$19.99</code></td>
</tr>
<tr class="even">
<td><code>&lt;[^&gt;]+&gt;</code></td>
<td>Any HTML tag</td>
</tr>
</tbody>
</table>
<p>You can test your regular expressions expressions at <a href="https://regexr.com/">regexr.com</a>.</p>
<p><strong>Python Example Using Regular Expressions:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="PA2.html#cb2-1" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb2-2"><a href="PA2.html#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="PA2.html#cb2-3" tabindex="-1"></a>html_content <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb2-4"><a href="PA2.html#cb2-4" tabindex="-1"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb2-5"><a href="PA2.html#cb2-5" tabindex="-1"></a><span class="st">  &lt;body&gt;</span></span>
<span id="cb2-6"><a href="PA2.html#cb2-6" tabindex="-1"></a><span class="st">    &lt;div class=&quot;article&quot;&gt;</span></span>
<span id="cb2-7"><a href="PA2.html#cb2-7" tabindex="-1"></a><span class="st">      &lt;h2&gt;Sample Article&lt;/h2&gt;</span></span>
<span id="cb2-8"><a href="PA2.html#cb2-8" tabindex="-1"></a><span class="st">      &lt;p&gt;Published on 2024-12-05&lt;/p&gt;</span></span>
<span id="cb2-9"><a href="PA2.html#cb2-9" tabindex="-1"></a><span class="st">      &lt;p&gt;Price: $19.99&lt;/p&gt;</span></span>
<span id="cb2-10"><a href="PA2.html#cb2-10" tabindex="-1"></a><span class="st">      &lt;a href=&quot;https://example.com&quot;&gt;Read more&lt;/a&gt;</span></span>
<span id="cb2-11"><a href="PA2.html#cb2-11" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb2-12"><a href="PA2.html#cb2-12" tabindex="-1"></a><span class="st">  &lt;/body&gt;</span></span>
<span id="cb2-13"><a href="PA2.html#cb2-13" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb2-14"><a href="PA2.html#cb2-14" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb2-15"><a href="PA2.html#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="PA2.html#cb2-16" tabindex="-1"></a><span class="co"># Extract article title</span></span>
<span id="cb2-17"><a href="PA2.html#cb2-17" tabindex="-1"></a>title <span class="op">=</span> re.search(<span class="vs">r&#39;&lt;h2&gt;(.*?)&lt;/h2&gt;&#39;</span>, html_content)</span>
<span id="cb2-18"><a href="PA2.html#cb2-18" tabindex="-1"></a><span class="bu">print</span>(title.group(<span class="dv">1</span>))  <span class="co"># Output: Sample Article</span></span>
<span id="cb2-19"><a href="PA2.html#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="PA2.html#cb2-20" tabindex="-1"></a><span class="co"># Extract date</span></span>
<span id="cb2-21"><a href="PA2.html#cb2-21" tabindex="-1"></a>date <span class="op">=</span> re.search(<span class="vs">r&#39;\d</span><span class="sc">{4}</span><span class="vs">-\d</span><span class="sc">{2}</span><span class="vs">-\d</span><span class="sc">{2}</span><span class="vs">&#39;</span>, html_content)</span>
<span id="cb2-22"><a href="PA2.html#cb2-22" tabindex="-1"></a><span class="bu">print</span>(date.group(<span class="dv">0</span>))  <span class="co"># Output: 2024-12-05</span></span>
<span id="cb2-23"><a href="PA2.html#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="PA2.html#cb2-24" tabindex="-1"></a><span class="co"># Extract price</span></span>
<span id="cb2-25"><a href="PA2.html#cb2-25" tabindex="-1"></a>price <span class="op">=</span> re.search(<span class="vs">r&#39;\$[0-9]+\.[0-9]</span><span class="sc">{2}</span><span class="vs">&#39;</span>, html_content)</span>
<span id="cb2-26"><a href="PA2.html#cb2-26" tabindex="-1"></a><span class="bu">print</span>(price.group(<span class="dv">0</span>))  <span class="co"># Output: $19.99</span></span>
<span id="cb2-27"><a href="PA2.html#cb2-27" tabindex="-1"></a></span>
<span id="cb2-28"><a href="PA2.html#cb2-28" tabindex="-1"></a><span class="co"># Extract link</span></span>
<span id="cb2-29"><a href="PA2.html#cb2-29" tabindex="-1"></a>link <span class="op">=</span> re.search(<span class="vs">r&#39;href=&quot;(.*?)&quot;&#39;</span>, html_content)</span>
<span id="cb2-30"><a href="PA2.html#cb2-30" tabindex="-1"></a><span class="bu">print</span>(link.group(<span class="dv">1</span>))  <span class="co"># Output: https://example.com</span></span></code></pre></div>
<p>Regular expressions can be concise and effective for small-scale, well-formatted content. However, for more complex HTML, tools like XPath (or HTML parsers like BeautifulSoup) are generally more reliable.</p>
</div>
<div id="your-task" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Your task<a href="PA2.html#your-task" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You should use XPath and Regular expressions to filter the HTML websites you gathered in PA1.</p>
<ol style="list-style-type: decimal">
<li>Prepare a plain text version of the website where you remove static elements like website headers, menus, footers, etc., while keeping the page’s content.</li>
<li>Define criteria for splitting the page into multiple thematic sections. Some suggestions include using paragraphs, sentences, page sections, or any other indicators, with the goal of each section being a complete description of one topic. Include a brief description of the criteria in the PA2 report.</li>
<li>You have to select the most appropriate strategy for dividing text and list its advantages and disadvantages in the PA2 report. It is often necessary to conduct some testing to determine what works best. Without a proper approach, you risk overlooking important information or providing incomplete or out-of-context retrieved segments when querying the vector database. Some of the key factors to consider when dividing the text into smaller portions are the size of segments and context preservation.</li>
</ol>
</div>
</div>
<div id="storing-extracted-information-in-a-vector-database" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Storing extracted information in a vector database<a href="PA2.html#storing-extracted-information-in-a-vector-database" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The next step of the assignment is to calculate embeddings for text segments and store the extracted information in a <strong>vector database</strong>. For this, you will expand the database you created in PA1 with a new table that stores <strong>document segments</strong> and their <strong>vector representations</strong>.</p>
<p>For a more streamlined start, you can utilize the following <a href="notebooks/vector_db_sample.ipynb">sample</a>.</p>
<div id="preparing-the-database" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Preparing the database<a href="PA2.html#preparing-the-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make sure you are using a <a href="https://github.com/pgvector/pgvector">pgvector database</a>. Pgvector is a PostgreSQL extension that adds support for storing and indexing vector data. You can create a new pgvector database using the following command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="PA2.html#cb3-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--name</span> postgresql-wier <span class="dt">\</span></span>
<span id="cb3-2"><a href="PA2.html#cb3-2" tabindex="-1"></a> <span class="at">-e</span> POSTGRES_PASSWORD=SecretPassword <span class="dt">\</span></span>
<span id="cb3-3"><a href="PA2.html#cb3-3" tabindex="-1"></a> <span class="at">-e</span> POSTGRES_USER=user <span class="dt">\</span></span>
<span id="cb3-4"><a href="PA2.html#cb3-4" tabindex="-1"></a> <span class="at">-e</span> POSTGRES_DB=wier <span class="dt">\</span></span>
<span id="cb3-5"><a href="PA2.html#cb3-5" tabindex="-1"></a> <span class="at">-v</span> <span class="va">$PWD</span>/pgdata:/var/lib/postgresql/data <span class="dt">\</span></span>
<span id="cb3-6"><a href="PA2.html#cb3-6" tabindex="-1"></a> <span class="at">-v</span> <span class="va">$PWD</span>/init-scripts:/docker-entrypoint-initdb.d <span class="dt">\</span></span>
<span id="cb3-7"><a href="PA2.html#cb3-7" tabindex="-1"></a> <span class="at">-p</span> 5432:5432 <span class="dt">\</span></span>
<span id="cb3-8"><a href="PA2.html#cb3-8" tabindex="-1"></a> <span class="at">-d</span> pgvector/pgvector:pg16</span></code></pre></div>
<p>In your database, enable the <code>vector</code> extension using the statement:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="PA2.html#cb4-1" tabindex="-1"></a><span class="kw">CREATE</span> EXTENSION <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> vector;</span></code></pre></div>
<p>Once you have the database set up, add a new column to the <code>page</code> table to store <strong>cleaned plain text content</strong>, and create a new table to store <strong>page segments</strong> and their <strong>vector embeddings</strong>.</p>
<p><img src="img/pa2/vector-db-schema.png" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="PA2.html#cb5-1" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> crawl_db.page <span class="kw">ADD</span> <span class="kw">COLUMN</span> cleaned_content TEXT;</span>
<span id="cb5-2"><a href="PA2.html#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="PA2.html#cb5-3" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> crawl_db.page_segment (</span>
<span id="cb5-4"><a href="PA2.html#cb5-4" tabindex="-1"></a>  <span class="kw">id</span> serial <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb5-5"><a href="PA2.html#cb5-5" tabindex="-1"></a>  page_id <span class="dt">integer</span>,</span>
<span id="cb5-6"><a href="PA2.html#cb5-6" tabindex="-1"></a>  page_segment TEXT,</span>
<span id="cb5-7"><a href="PA2.html#cb5-7" tabindex="-1"></a>  embedding vector(<span class="dv">768</span>)</span>
<span id="cb5-8"><a href="PA2.html#cb5-8" tabindex="-1"></a>);</span>
<span id="cb5-9"><a href="PA2.html#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="PA2.html#cb5-10" tabindex="-1"></a><span class="kw">ALTER</span> <span class="kw">TABLE</span> crawl_db.page_segment</span>
<span id="cb5-11"><a href="PA2.html#cb5-11" tabindex="-1"></a>  <span class="kw">ADD</span> <span class="kw">CONSTRAINT</span> fk_page_page_segment</span>
<span id="cb5-12"><a href="PA2.html#cb5-12" tabindex="-1"></a>  <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (page_id)</span>
<span id="cb5-13"><a href="PA2.html#cb5-13" tabindex="-1"></a>  <span class="kw">REFERENCES</span> crawl_db.page(<span class="kw">id</span>)</span>
<span id="cb5-14"><a href="PA2.html#cb5-14" tabindex="-1"></a>  <span class="kw">ON</span> <span class="kw">DELETE</span> <span class="kw">RESTRICT</span>;</span></code></pre></div>
<p>You are encouraged to extend the database schema with additional metadata fields that may be useful during retrieval — for example, the HTML tag, section title, heading level, or local context of a segment. If you do, describe these design decisions in your report.</p>
</div>
<div id="generate-vector-embeddings" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Generate vector embeddings<a href="PA2.html#generate-vector-embeddings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next step is to generate <strong>vector embeddings</strong> for each page segment. Embeddings are fixed-length vector representations of text that capture its semantic meaning.</p>
<p>You should experiment with <strong>different embedding models</strong>, such as:</p>
<ul>
<li><code>all-MiniLM-L6-v2</code> from <a href="https://www.sbert.net/">sentence-transformers</a></li>
<li>OpenAI’s <code>text-embedding-ada-002</code></li>
<li>Hugging Face Transformers like <code>distilbert-base-uncased</code></li>
<li>Any domain-specific models relevant to your dataset (e.g. legal, medical)</li>
</ul>
</div>
<div id="querying-the-database" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Querying the database<a href="PA2.html#querying-the-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By default, <em>pgvector</em> performs an exact search when querying the database. Adding <a href="https://github.com/pgvector/pgvector?tab=readme-ov-file#indexing">index</a> enables us to use approximate nearest neighbour (ANN) search, which takes less time when compared to exact search. The <em>pgvector</em> supports two indexes, HSNW and IVFFlat. Use one of them in your assignment.</p>
<p>Queries and segments that are similar will map to similar embeddings. By comparing a query embedding to the segment embeddings, you can retrieve the most relevant content based on the chosen metric, such as cosine distance, L1 distance, or inner product..</p>
<p>You can generate embeddings using Python libraries like <code>sentence-transformers</code>, <code>transformers</code>, or <code>openai</code>.</p>
<p>For each segment, compute its embedding and store it in the <code>embedding</code> column of the <code>page_segment</code> table.</p>
</div>
</div>
<div id="information-retrieval" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Information retrieval<a href="PA2.html#information-retrieval" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this part of the assignment, you will create a simple program that takes a <strong>query</strong> (for example, a user question) and retrieves the most relevant text segments from your database using <strong>vector similarity search</strong>.</p>
<p>You can use similarity operators provided by pgvector, such as:</p>
<ul>
<li><code>&lt;#&gt;</code> Inner product (higher is more similar)</li>
<li><code>&lt;=&gt;</code> Cosine distance (lower is more similar)</li>
<li><code>&lt;+&gt;</code> L1 distance (lower is more similar)</li>
</ul>
<p><strong>Your task is to experiment</strong> with:</p>
<ul>
<li>Different <strong>similarity metrics</strong></li>
<li>Different <strong>embedding models</strong></li>
<li>Including or excluding <strong>segment metadata</strong> in your embeddings (e.g., including the title or section tag)</li>
<li><strong>Chunking strategies</strong> for segmenting the page (fixed-length? by paragraph? by heading?)</li>
</ul>
<p>The goal is to find the <strong>best combination for your domain</strong>, so that given a query, your retriever consistently returns the most useful results.</p>
<p>You should implement a small Python demo program that:</p>
<ol style="list-style-type: decimal">
<li>Accepts a user query</li>
<li>Computes its embedding</li>
<li>Performs a similarity search over the segment embeddings in your database</li>
<li>Returns and displays the top-k most relevant segments</li>
</ol>
<p>In the demo program, include five queries that return relevant results for your domain, and prepare at least one query that does not return the expected result.</p>
</div>
<div id="basic-tools-1" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Basic tools<a href="PA2.html#basic-tools-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Utilize the following Jupyter notebooks for a more streamlined start:</p>
<ul>
<li><a href="notebooks/introduction_to_vector_databases.ipynb">Introductuctory sample to vector databases</a>.</li>
<li><a href="notebooks/vector_db_sample.ipynb">Sample for the pgvector database</a></li>
</ul>
</div>
<div id="what-to-submit-1" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> What to submit<a href="PA2.html#what-to-submit-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Publish your work into the <strong>same repository</strong> as you used for the first assignment. The repository must comply with the following structure:</p>
<pre><code>pa2/
├── report-extraction.pdf           # PDF report with description and evaluation
├── README.md                       # Setup instructions for running the code
├── implementation-extraction/      # Your implementation code (well documented)
│   └── demo.py                     # A demo script that allows us to test the retriever
├── extraction-db/                  # Your database including extracted segments and their embeddings</code></pre>
<hr />
<div id="what-to-include-in-the-report-1" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> What to include in the report<a href="PA2.html#what-to-include-in-the-report-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your report should include the following:</p>
<ul>
<li>Information about how you performed website filtering.</li>
<li>Approach to dividing the text, including criteria for splitting the page into multiple thematic sections, the implemented strategy for dividing text, and advantages and disadvantages of the implemented strategy.</li>
<li>What embeddings did you decide to use, and why</li>
<li>What similarity metric did you decide to use, and why</li>
<li>Examples of queries and your retriever’s responses</li>
<li>Limitations of your document retriever (e.g. examples of queries with inadequate responses)</li>
</ul>
<p><strong>Make sure to also describe methods you tried but decided not to use.</strong></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="PA1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": {}
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 1
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  }
});
});
</script>

</body>

</html>
